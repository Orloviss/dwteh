$(function(){var a=$("body");$(window).on("resize",function(){var b=$(this).height()-($(".js-header").height()+$(".js-price-list").height()+$(".js-banner-price").height()+20);console.log(b);$(".js-index-content").css("padding-top",b+"px")});$(window).trigger("resize");$(".js-banner-price img").on("load",function(){$(window).trigger("resize")});$(a).on("click",".js-link-lightbox",function(d){d.preventDefault();var b=$(this).data("sources");if(b.length){var c=UIkit.lightbox.create(b);c.show()}}).on("click",".js-map-collapse > span",function(c){c.preventDefault();var b=$(this),d=b.parent();if(d.hasClass("open")){d.removeClass("open");b.find(".fa").removeClass("fa-angle-double-up").addClass("fa-angle-double-down")}else{d.addClass("open");b.find(".fa").removeClass("fa-angle-double-down").addClass("fa-angle-double-up")}map.container.fitToViewport()}).on("submit","form[data-form-clear]",function(d){var b=$(this),c=[];if(b.data("form-clear-besides")){c=b.data("form-clear-besides").split(",")}preSubmitForm($(this).get()[0],c)}).on("click","input[data-radio-checkbox]",function(){var b=$(this).parents(".uk-button-group"),c=$(this).is(":checked");b.find('input[type="checkbox"]').prop("checked",false);if(c){$(this).prop("checked",true)}}).on("click",".js-button-modal-ipoteka",function(){var b=$(this).data("id"),c=UIkit.modal("#modal-ipoteka");if(b){$("#modal-ipoteka").find('input[name="IpotekaForm[ipoteka_id]"]').val(b);if(c.isActive()){c.hide()}else{c.show()}}});$(".captcha-refresh").on("click",function(){$(this).next("img").trigger("click")});$(".js-form-ajax").on("beforeSubmit","form",function(f){f.preventDefault();var b=$(this),d=b.parents(".uk-modal").attr("id"),c=d?UIkit.modal(d):null;$.ajax({type:"POST",url:b.attr("action"),data:b.serializeArray(),success:function(e){if(e.success){b.find(".uk-alert").removeClass("uk-alert-danger uk-hidden").addClass("uk-alert-success").html(e.message);b.find('input[type="text"], textarea, select').val("");if(c){setTimeout(function(){c.hide()},3000)}}else{var g="";$.each(e.errors,function(h,i){$.each(i,function(k,j){g+=j+"<br>"})});b.find(".uk-alert").removeClass("uk-alert-success uk-hidden").addClass("uk-alert-danger").html(g)}},error:function(e,h,g){alert("ERROR")}});return false});if(typeof NovostroykiSearch==="object"&&$("#map-novostroyki").length){getMapItems("novostroyki",NovostroykiSearch)}});ymaps.ready(function(){if($("#map").length){var a=function(e){if(e.length){map=new ymaps.Map("map",{center:mapCenter,zoom:mapZoom,controls:[]});map.behaviors.disable("scrollZoom");map.controls.add(new ymaps.control.ZoomControl());var d={};if(typeof mapIcon!==typeof undefined){d={iconLayout:"default#image",iconImageHref:mapIcon,iconImageSize:mapIconSize,iconImageOffset:mapIconOffset}}var c=new ymaps.Placemark(e,{balloonContentHeader:mapTitle},d);map.geoObjects.add(c);map.setCenter(e);if(typeof mapPolygon!==typeof undefined){var b=new ymaps.Polygon(mapPolygon||[],{},{fillColor:"#FF0000",strokeColor:"#0000FF",opacity:0.4,strokeWidth:3,strokeStyle:"shortdash"});map.geoObjects.add(b);map.setBounds(b.geometry.getBounds(),{margin:70})}}};if(typeof mapCoordinates!==typeof undefined&&mapCoordinates.length){a(mapCoordinates)}if(typeof mapAddress!==typeof undefined){ymaps.geocode(mapAddress).then(function(c){var b=c.geoObjects.get(0).geometry.getCoordinates();a(b)})}}});function getMapItems(c,b){var a=ucFirst(c)+"Search",d={};d[a]=b;$.ajax({type:"POST",url:"/"+c+"/get-items",data:d,success:function(e){if(e.success){ymaps.ready(function(){map=new ymaps.Map("map-"+c,{center:[54.513845,36.261215],zoom:12,controls:["zoomControl","typeSelector"]});var f=function(g){var h=new ymaps.Placemark([g.coords[0],g.coords[1]],{},{iconLayout:"default#image",iconImageHref:g.photo,iconImageSize:[40,40],iconImageOffset:[-20,-20]});map.geoObjects.add(h);h.events.add("click",function(){var i="htmlMapItem"+ucFirst(c);map.balloon.open(h.geometry.getCoordinates(),"Загрузка..");$.ajax({type:"POST",url:"/"+c+"/get-item",data:{id:g.id},success:function(j){var k=window[i](j.item);map.balloon.open(h.geometry.getCoordinates(),k,{maxWidth:300})},error:function(j,l,k){alert("ERROR MAP")}})})};e.items.forEach(function(g){if(typeof g.coords!==typeof undefined&&g.coords.length===2&&g.coords[0]>0&&g.coords[1]>0){f(g)}else{ymaps.geocode(g.address).then(function(h){g.coords=h.geoObjects.get(0).geometry.getCoordinates();f(g)})}})})}else{alert(e.message)}},error:function(e,g,f){alert("ERROR")}})}function htmlMapItemNovostroyki(b){var a='<div class="novostroyki-list-map-item">';if(b.name){a+='<a href="'+b.url+'" class="name" target="_blank">'+b.name+"</a>"}if(b.address){a+='<p class="address"><i class="fa fa-map-marker" aria-hidden="true"></i> '+b.address+"</p>"}a+="</div>";return a}function ucFirst(a){return a.charAt(0).toUpperCase()+a.slice(1)}function preSubmitForm(b,c){if(typeof c===typeof undefined){c=[]}for(var a=0;a<b.elements.length;a++){var d=$(b.elements[a]);if((d.val()===""||d.val()==="0")&&c.indexOf(d.attr("name"))===-1){d.attr("disabled","true")}}}function changeRadioCheckbox(c){var a=c.parents(".uk-button-group"),b=c.is(":checked");a.find('input[type="checkbox"]').prop("checked",false);if(b){c.prop("checked",true)}};